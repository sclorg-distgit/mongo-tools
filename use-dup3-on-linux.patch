From f936fb050dc6b5fe4a96b485a6f069e8bdc59aeb Mon Sep 17 00:00:00 2001
From: JT Olds <hello@jtolds.com>
Date: Mon, 6 Jun 2016 16:25:22 -0600
Subject: [PATCH] Use dup3 on linux. Closes PR #4

---
 capture_linux.go | 33 +++++++++++++++++++++++++++++++++
 capture_other.go |  1 +
 2 files changed, 34 insertions(+)
 create mode 100644 capture_linux.go

diff --git a/capture_linux.go b/capture_linux.go
new file mode 100644
index 0000000..160a3b3
--- /dev/null
+++ b/capture_linux.go
@@ -0,0 +1,33 @@
+// Copyright (C) 2014 Space Monkey, Inc.
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//   http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package spacelog
+
+import (
+	"syscall"
+)
+
+// CaptureOutputToFd redirects the current process' stdout and stderr file
+// descriptors to the given file descriptor, using the dup3 syscall.
+func CaptureOutputToFd(fd int) error {
+	err := syscall.Dup3(fd, syscall.Stdout, 0)
+	if err != nil {
+		return err
+	}
+	err = syscall.Dup3(fd, syscall.Stderr, 0)
+	if err != nil {
+		return err
+	}
+	return nil
+}
diff --git a/capture_other.go b/capture_other.go
index 5a62a2a..5fb2209 100644
--- a/capture_other.go
+++ b/capture_other.go
@@ -13,6 +13,7 @@
 // limitations under the License.
 
 // +build !windows
+// +build !linux
 
 package spacelog
 
